<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="storage_backend_view_form" model="ir.ui.view">
        <field name="model">storage.backend</field>
        <field name="inherit_id" ref="storage_backend.storage_backend_view_form" />
        <field name="arch" type="xml">
            <button name="action_test_config" position="after">
                <button
                    type="object"
                    name="action_ensure_bucket_exists"
                    string="Test S3 Bucket connection"
                    attrs="{'invisible':[('backend_type', '!=', 'amazon_s3')]}"
                    context="{'force_s3_check': True}"
                />
            </button>
            <group name="config" position="after">
                <group
                    name="Amazon S3"
                    string="Amazon S3"
                    attrs="{'invisible': [('backend_type', '!=', 'amazon_s3')]}"
                >
                    <group>
                        <field name="aws_host" />
                        <field
                            name="aws_access_key_id"
                            attrs="{'required': [('backend_type', '=', 'amazon_s3')]}"
                        />
                        <field
                            name="aws_secret_access_key"
                            attrs="{'required': [('backend_type', '=', 'amazon_s3')], 'readonly':[('backend_type', '!=', 'amazon_s3')]}"
                        />
                        <field
                            name="aws_bucket"
                            attrs="{'required': [('backend_type', '=', 'amazon_s3')]}"
                        />
                        <field name="s3_bucket_exists" />
                        <field name="aws_cache_control" />
                        <field name="aws_file_acl" />
                    </group>
                    <group>
                        <field
                            name="aws_region"
                            widget="radio"
                            attrs="{'required': [('backend_type', '=', 'amazon_s3')]}"
                        />
                        <field
                            name="aws_other_region"
                            attrs="{'invisible': [('aws_region', '!=', 'other')]}"
                        />
                    </group>
                </group>
            </group>
        </field>
    </record>
</odoo>
